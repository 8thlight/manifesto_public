var Manifesto={init:function(){$("#content").hide(),Manifesto.fetchSignatories(1),Manifesto.translate("en"),Manifesto.switchLocale()},translate:function(e){Transitions.before(function(){$("div#sign, div#reading, div#message").hide(),$.fetchStaticJSON("jsons/reading/"+e+".json").done(function(e){$("div#reading").html(Partials.renderReading(e))}),$.fetchStaticJSON("jsons/sign/"+e+".json").done(function(e){$("div#sign").html(Partials.renderSign(e))}),$.fetchStaticJSON("jsons/manifesto/"+e+".json").done(function(t){$("html").attr("lang",e),$("title").html(t.title),$("#heading_title").attr("href","api.html#"+e),Manifesto.fetchContent(t),$("#content_top, #manifesto, #signatory-table, #footer").show(),Transitions.after(function(){Manifesto.toggleSignForm(),Manifesto.toggleReading(),Manifesto.toggleHeading(),Manifesto.bindSignButton(e),Transitions.infiniteScroll(function(){Manifesto.fetchMoreSignatories()})})})})},signatureFormJSON:function(){return{sign:{name:$("#signatory_name").val(),email:$("#signatory_email").val(),location:$("#signatory_location").val()}}},bindSignButton:function(e){$("#sign-button").on("click",function(){$.postJSON(e+"/sign/sign",Manifesto.signatureFormJSON()).done(function(t){t.success?Transitions.before(function(){$.fetchStaticJSON("jsons/sign/"+e+".json").done(function(e){var t=e.confirmation;t.signatory_email=$("#signatory_email").val(),$("#message").html(Partials.renderConfirmation(t)),$("#message").show(),$("#sign").hide(),Transitions.after()})}):Transitions.before(function(){var n=t.errors;$.fetchStaticJSON("jsons/sign/"+e+".json").done(function(e){e.errors=n,$("#signature-form-errors").html(Partials.renderSignatureErrors(e)),Transitions.after()})})})})},fetchContent:function(e){$("#content_top").html(Partials.renderContentTop(e)),$("#manifesto").html(Partials.renderManifesto(e)),$("#footer").html(Partials.renderFooter(e))},fetchMoreSignatories:function(){var e=$("#signatory-table").data("id")+1;$("#signatory-table").data("id",e),Manifesto.fetchSignatories(e)},fetchSignatories:function(e){$.fetchJSON("signatories?page="+e).done(function(e){var t="";$.each(e,function(n){var r=n%3;r==0&&(t+="<tr>");var i=e[n];t=t+"<td>"+i.name+" ("+i.location+")"+"</td>",r==2&&(t+="</tr>")}),$("#signatory-table").append(t)})},switchLocale:function(){$("a#en, a#zh-cn, a#es").on("click",function(){Manifesto.translate($(this).attr("id"))})},toggleSignForm:function(){$("a#sign").bind("click",function(){Transitions.before(function(){$("#signatory-table, #manifesto, div#reading").hide(),$("div#sign").show(),Transitions.after()}),Transitions.infiniteUnscroll()})},toggleReading:function(){$("a#reading").bind("click",function(){Transitions.before(function(){$("#signatory-table, #manifesto, div#sign").hide(),$("div#reading").show(),Transitions.after()}),Transitions.infiniteUnscroll()})},toggleHeading:function(){$(".heading_title").on("click",function(){Transitions.before(function(){$("div#sign, div#reading, div#message").hide(),$("#signatory-table, #manifesto").show(),Transitions.after(function(){Transitions.infiniteScroll(function(){Manifesto.fetchMoreSignatories()})})})})}};